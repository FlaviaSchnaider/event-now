{"ast":null,"code":"import _objectSpread from\"C:/event-now/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useEffect,useState}from'react';import{api}from'../utils/api';import{useParams,useNavigate}from'react-router-dom';import'./VotePage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function VotePage(){const{id}=useParams();const[event,setEvent]=useState(null);const[answers,setAnswers]=useState({});const navigate=useNavigate();useEffect(()=>{const fetchData=async()=>{const res=await api.get(\"/events/\".concat(id));setEvent(res.data);};fetchData();},[id]);const handleChange=(qid,value)=>{setAnswers(prev=>_objectSpread(_objectSpread({},prev),{},{[qid]:value}));};const handleMultiChange=(qid,value)=>{const prevValues=answers[qid]||[];const exists=prevValues.includes(value);const updated=exists?prevValues.filter(v=>v!==value):[...prevValues,value];setAnswers(prev=>_objectSpread(_objectSpread({},prev),{},{[qid]:updated}));};const submit=async()=>{const unanswered=event.questions.some(q=>{const answer=answers[q.id];return q.multi?!answer||answer.length===0:!answer;});if(unanswered){alert(\"Por favor, responda todas as perguntas antes de enviar.\");return;}try{await api.post(\"/events/\".concat(id,\"/vote\"),{answers});alert(\"Voto enviado com sucesso!\");}catch(err){console.error(err);alert(\"Erro ao enviar voto. Tente novamente.\");}};if(!event)return/*#__PURE__*/_jsx(\"p\",{children:\"Carregando...\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"vote-page\",children:[/*#__PURE__*/_jsx(\"h1\",{children:event.title}),/*#__PURE__*/_jsx(\"p\",{className:\"vote-description\",children:event.description}),event.questions.map(q=>/*#__PURE__*/_jsxs(\"div\",{className:\"vote-card\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"vote-question\",children:q.text}),/*#__PURE__*/_jsx(\"div\",{className:\"vote-options\",children:q.options.map(opt=>/*#__PURE__*/_jsxs(\"label\",{className:\"vote-option\",children:[/*#__PURE__*/_jsx(\"input\",{type:q.multi?\"checkbox\":\"radio\",name:q.id,value:opt._id,checked:q.multi?(answers[q.id]||[]).includes(opt._id):answers[q.id]===opt._id,onChange:()=>{q.multi?handleMultiChange(q.id,opt._id):handleChange(q.id,opt._id);}}),/*#__PURE__*/_jsx(\"span\",{children:opt.text})]},opt._id))})]},q.id)),/*#__PURE__*/_jsxs(\"div\",{className:\"vote-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"vote-submit\",onClick:submit,children:\"Enviar Votos\"}),/*#__PURE__*/_jsx(\"button\",{className:\"vote-secondary\",onClick:()=>navigate(\"/event/\".concat(id,\"/results\")),children:\"Ver Resultados\"})]})]});}","map":{"version":3,"names":["useEffect","useState","api","useParams","useNavigate","jsx","_jsx","jsxs","_jsxs","VotePage","id","event","setEvent","answers","setAnswers","navigate","fetchData","res","get","concat","data","handleChange","qid","value","prev","_objectSpread","handleMultiChange","prevValues","exists","includes","updated","filter","v","submit","unanswered","questions","some","q","answer","multi","length","alert","post","err","console","error","children","className","title","description","map","text","options","opt","type","name","_id","checked","onChange","onClick"],"sources":["C:/event-now/frontend/src/pages/VotePage.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport { api } from '../utils/api';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport './VotePage.css';\n\nexport default function VotePage() {\n  const { id } = useParams();\n  const [event, setEvent] = useState(null);\n  const [answers, setAnswers] = useState({});\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const res = await api.get(`/events/${id}`);\n      setEvent(res.data);\n    };\n    fetchData();\n  }, [id]);\n\n  const handleChange = (qid, value) => {\n    setAnswers(prev => ({ ...prev, [qid]: value }));\n  };\n\n  const handleMultiChange = (qid, value) => {\n    const prevValues = answers[qid] || [];\n    const exists = prevValues.includes(value);\n    const updated = exists\n      ? prevValues.filter(v => v !== value)\n      : [...prevValues, value];\n    setAnswers(prev => ({ ...prev, [qid]: updated }));\n  };\n\n  const submit = async () => {\n    const unanswered = event.questions.some(q => {\n      const answer = answers[q.id];\n      return q.multi ? !answer || answer.length === 0 : !answer;\n    });\n\n    if (unanswered) {\n      alert(\"Por favor, responda todas as perguntas antes de enviar.\");\n      return;\n    }\n\n    try {\n      await api.post(`/events/${id}/vote`, { answers });\n      alert(\"Voto enviado com sucesso!\");\n    } catch (err) {\n      console.error(err);\n      alert(\"Erro ao enviar voto. Tente novamente.\");\n    }\n  };\n\n\n  if (!event) return <p>Carregando...</p>;\n\n  return (\n    <div className=\"vote-page\">\n      <h1>{event.title}</h1>\n      <p className=\"vote-description\">{event.description}</p>\n\n      {event.questions.map(q => (\n        <div key={q.id} className=\"vote-card\">\n          <p className=\"vote-question\">{q.text}</p>\n          <div className=\"vote-options\">\n            {q.options.map(opt => (\n              <label key={opt._id} className=\"vote-option\">\n                <input\n                  type={q.multi ? \"checkbox\" : \"radio\"}\n                  name={q.id}\n                  value={opt._id}\n                  checked={\n                    q.multi\n                      ? (answers[q.id] || []).includes(opt._id)\n                      : answers[q.id] === opt._id\n                  }\n                  onChange={() => {\n                    q.multi\n                      ? handleMultiChange(q.id, opt._id)\n                      : handleChange(q.id, opt._id);\n                  }}\n                />\n                <span>{opt.text}</span>\n              </label>\n            ))}\n          </div>\n        </div>\n      ))}\n\n      <div className=\"vote-buttons\">\n        <button className=\"vote-submit\" onClick={submit}>Enviar Votos</button>\n        <button className=\"vote-secondary\" onClick={() => navigate(`/event/${id}/results`)}>\n          Ver Resultados\n        </button>\n      </div>\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}